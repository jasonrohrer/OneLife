#!/bin/bash

#
# Modification History
#
# 2010-April-2        Andy Sommerville
# - Added a few "|| exit 1" to terminate as soon as error occurs.
# - Read menu choice from argv[1].
# - Added "-p" to mkdir to suppress "already exists" message.
# - Added automatic backup of "resourceCache". (wish I'd thought of that a few minutes ago....)
#
# 2007-November-12    Jason Rohrer
# Copied from Cultivation.
#


chmod u+x ./configure
./configure $@ || exit 1



cd gameSource


echo "Building OneLife..."

make || exit 1



cd ..


echo "Making directories"
mkdir -p dist
mkdir -p dist/graphics
mkdir -p dist/otherSounds
mkdir -p dist/settings
mkdir -p dist/languages
mkdir -p dist/reverbCache
mkdir -p dist/groundTileCache


echo "Copying items from build into dist directory"
cp gameSource/OneLife dist/OneLifeApp
cp documentation/Readme.txt dist/.
cp no_copyright.txt dist/.
cp gameSource/graphics/* dist/graphics/.
cp gameSource/otherSounds/* dist/otherSounds/.
cp -u gameSource/settings/* dist/settings/.
cp gameSource/languages/* dist/languages/.
cp gameSource/language.txt dist/.
cp gameSource/us_english_60.txt dist/.
cp gameSource/reverbImpulseResponse.aiff dist/.

echo "Linking resources into dist directory"
ln -s ../OneLifeData7/animations dist/.
ln -s ../OneLifeData7/categories dist/.
ln -s ../OneLifeData7/ground dist/.
ln -s ../OneLifeData7/music dist/.
ln -s ../OneLifeData7/objects dist/.
ln -s ../OneLifeData7/sounds dist/.
ln -s ../OneLifeData7/sprites dist/.
ln -s ../OneLifeData7/transitions dist/.
ln -s ../OneLifeData7/dataVersionNumber.txt dist/.

echo "Run OneLifeApp to play."




